---
title: "Stevia Microbiota"
author: "Edna Chiang"
date: "July 19, 2018"
output:
  html_document:
    toc: true
    toc_float: true
---

```{r, include=F}
# Load Libraries
library(ape)
library(dplyr)
library(ggplot2)
library(gplots)
library(phangorn)
library(tidyr)
library(vegan)
library(phyloseq)
library(grid)
library(pgirmess)
library(lme4)
library(kableExtra)
theme_set(theme_bw())
set.seed(1)

# Load Functions
veganCovEllipse <- function(cov, center = c(0, 0), scale = 1, npoints = 100) {
    theta <- (0:npoints) * 2 * pi/npoints
    Circle <- cbind(cos(theta), sin(theta))
    t(center + scale * t(Circle %*% chol(cov)))
}
```


```{r, include=F}
# Load Phyloseq Object
load("Physeq.RData")
load("Physeq.pair.RData")
load("Physeq.pre.RData")
load("Physeq.post.RData")
load("Physeq.post.rem.RData")
load("Physeq.fem.RData")
load("Physeq.mal.RData")
load("Physeq.pre.fem.RData")
load("Physeq.pre.mal.RData")
load("Physeq.post.fem.RData")
load("Physeq.post.mal.RData")
load("Physeq.post.fem.rem.RData")
load("Physeq.post.mal.rem.RData")
load("Physeq.hf.RData")
load("Physeq.lf.RData")
load("Physeq.sc.RData")
load("Physeq.tv.RData")
```

# Description  
This is a quick summary of the follow-up analyses to Sarah's thesis that I've performed.  
    
I included only individuals with both pre-treatment and post-treatment samples as I run a few paired tests and want to keep the samples consistent throughout all analyses. I removed 4 individuals, resulting in the following final sample count:  
```{r, echo=F}
samps <- data.frame(rep("NA",4))
colnames(samps) <- "Treatment"
samps$Treatment <- c("High Fat", "Low Fat", "Saccharin", "Stevia")
samps$N <- c(9, 10, 9, 8)
samps$Female <- c(4, 5, 5, 4)
samps$Male <- c(5, 5, 4, 4)
kable(samps, "html") %>% kable_styling(full_width=F)
```
   
# Phylum-Level Composition  
The phyla are listed in order of highest overall relative abundance to lowest overall relative abundance. Phyla with a total relative abundance of < 0.01% were removed. Error bars represent the interquartile range.  

```{r, echo=F, fig.height=6, fig.width=10, warning=F}
# Merge samples with the same taxonomic rank
goodphy <- tax_glom(physeq.pair, taxrank="Phylum")

# Transform each merged phylum count to rel abund
phy99 <- transform_sample_counts(goodphy, function(x){(x/sum(x))*100})

# Remove any phyla with <0.1% rel abund
phy99 <- prune_taxa(taxa_sums(phy99) > 0.01, phy99)

# Organize
phy.df <- psmelt(phy99)
phy.df$Phylum <- ordered(phy.df$Phylum, levels=c("Firmicutes", "Bacteroidetes", "Verrucomicrobia", "Tenericutes", "Proteobacteria", "Actinobacteria", "Unclassified", "Cyanobacteria"))
phy.df$Phylum[which(is.na(phy.df$Phylum))] <- rep("Unclassified",length(which(is.na(phy.df$Phylum))))

phy.sum <- phy.df %>%
  group_by(Treatment, Time, Phylum) %>%
  summarize(Mean = mean(Abundance),
            Median = median(Abundance),
            SD = sd(Abundance),
            SE = (sd(Abundance)/(sqrt(length(Abundance)))),
            iqr = IQR(Abundance))

# Calculate IQR limits
phy.sum$iqr.min <- phy.sum$Median - 0.5*phy.sum$iqr
phy.sum[which(phy.sum$iqr.min < 0),10] <- 0
  # Any IQR min < 0, change to 0 (otherwise error bar won't plot)
phy.sum$iqr.max <- phy.sum$Median + 0.5*phy.sum$iqr


### Barplot ###
ggplot(phy.sum, aes(x=Phylum, y=Median, fill=Phylum)) +
  geom_bar(stat="identity", color="black") +
  facet_grid(Time ~ Treatment) +
  geom_errorbar(aes(ymax=iqr.max, ymin=iqr.min), width=0.25) +
  scale_fill_manual(values=c("#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#f781bf", "#a65628", "#ffff33", "#ff7f00")) +
  xlab("Phyla") +
  ylab("Median Relative Abundance for Phyla > 0.01%") +
  scale_y_continuous(limits=c(0,80), expand=c(0,0))+
  theme(axis.text.x = element_blank(),
        panel.spacing=unit(1, "lines"),
        axis.title = element_text(size=16),
        strip.text.x = element_text(size=12),
        strip.text.y = element_text(size=12),
        axis.text.y = element_text(size=12),
        legend.title = element_text(size = 14),
        legend.text = element_text(size=12))
```

There are some interesting (& unexpected?) trends if we take into account sex:  
```{r, echo=F, fig.height=10, fig.width=10}
### Testing barplot for sex + treatment + time
test <- phy.df %>%
  group_by(Treatment, Time, Sex, Phylum) %>%
  summarize(Mean = mean(Abundance),
            Median = median(Abundance),
            SD = sd(Abundance),
            SE = (sd(Abundance)/(sqrt(length(Abundance)))),
            iqr = IQR(Abundance))
test$iqr.min <- test$Median - 0.5*test$iqr
test[which(test$iqr.min < 0),10] <- 0
  # Any IQR min < 0, change to 0 (otherwise error bar won't plot)
test$iqr.max <- test$Median + 0.5*test$iqr
ggplot(test, aes(x=Phylum, y=Median, fill=Phylum)) +
  geom_bar(stat="identity", color="black") +
  facet_grid(Time + Sex ~ Treatment) +
  geom_errorbar(aes(ymax=iqr.max, ymin=iqr.min), width=0.25) +
  scale_fill_manual(values=c("#e41a1c", "#377eb8", "#4daf4a", "#984ea3", "#f781bf", "#a65628", "#ffff33", "#ff7f00")) +
  xlab("Phyla") +
  ylab("Median Relative Abundance for Phyla > 0.01%") +
  scale_y_continuous(limits=c(0,80), expand=c(0,0))+
  theme(axis.text.x = element_blank(),
        panel.spacing=unit(1, "lines"),
        axis.title = element_text(size=16),
        strip.text.x = element_text(size=12),
        strip.text.y = element_text(size=12),
        axis.text.y = element_text(size=12),
        legend.title = element_text(size = 14),
        legend.text = element_text(size=12))
```
Trends that caught my eye (not statistically tested yet):  

* Pre-treatment females generally have a higher % Bacteroidetes compared to males
    + Especially in High Fat Pre-treatment
* Saccharin Post-treatment
    + Females have higher % Verrucomicrobia compared to males

   
# Within-Sample Diversity (Alpha) 
  

### Chao Richness  
Chao is an estimate of richness (how many unique OTUs exist in a particular sample).
```{r, echo=F, fig.height=4, fig.width=6.5}
adiv.pair <- data.frame(sample_data(physeq.pair))

# Chao
ggplot(adiv.pair, aes(x=Treatment, y=chao, fill = Treatment)) +
  geom_boxplot(position=position_dodge(1)) +
  geom_point() + 
  facet_grid(. ~ Time) +
  xlab("Treatment") +
  scale_fill_manual(values=c("brown2", "rosybrown", "limegreen", "dodgerblue2")) +
  ylab("Chao Richness")
```
  
* Post-treatment groups are significantly different (adj p-val = 0.004):
    + High Fat vs. Low Fat
    + Low Fat vs. Saccharin
  
* High Fat Pre-treatment and Post-treatment are significantly different (adj p-val = 0.018)

  
### Shannon Diversity  
Shannon's Index is an estimate of diversity, taking into account both the presence/absence and abundance of OTUs.  

```{r, echo=F, fig.height=4, fig.width=6.5}
# Shannon
ggplot(adiv.pair, aes(x=Treatment, y=shannon, fill = Treatment)) +
  geom_boxplot(position=position_dodge(1)) +
  geom_point() + 
  facet_grid(. ~ Time) +
  scale_fill_manual(values=c("brown2", "rosybrown", "limegreen", "dodgerblue2")) +
  xlab("Treatment") +
  ylab("Shannon Diversity")
```
  
No significant differences.
  



# Between-Sample Diversity (Beta)  
I used Bray-Curtis dissimilarity, which considers both presence/absence and weight (abundance).  
  
In the ordination, each point is 1 sample. The distance betwen points is inversely related to how similar the samples are.  
Closer points = more similar.  
Farther points = less similar.  

```{r, include=F}
### Paired
bray.nmds <- ordinate(physeq=physeq.pair, method="NMDS", distance="bray")
  # stress = 8.822573e-05

test <- plot_ordination(physeq=physeq.pair, ordination=bray.nmds, color="Treatment", shape="Time") +
  scale_color_manual(values=c("brown2", "rosybrown", "limegreen", "dodgerblue2")) +
  scale_shape_manual(values=c(19,24)) +
   geom_point(size=2, stroke=1.5)
test$layers <- test$layers[-1]
```

```{r, echo=F, fig.height=4.5, fig.width=7}
test
```
  
Pre-treatment vs. Post-treatment samples cluster distinctly for all samples except Low Fat.
Within each treatment, Pre vs. Post are significantly different (all adj pvals = 0.005).  
To determine what categorical factors are contributing to between-sample differences, I used PERMANOVA to evaluate:  

* Time
    + Pre-treatment vs. Post-treatment
* Treatment
    + High Fat, Low Fat, Saccharin, Stevia
* Sex
    + Female, Male
* Individual
    + My attempt to account for the paired nature of the data

```{r, echo=F}
samps <- data.frame(rep("NA",5))
colnames(samps) <- "Factor"
samps$Factor <- c("Time", "Treatment", "Sex", "Individual", "Residual")
samps$pval <- c(0.001, 0.001, 0.001, 0.907, NA)
samps$R2 <- c(0.258, 0.123, 0.074, 0.230, 0.349)

kable(samps, "html") %>% kable_styling(full_width=F)
```
  

* Time accounts for the most variation in the data, followed by Treatment and Sex
* Individual accounted for quite a bit of the data variation, but was not significant (likely because we have a small n (2) for each individual)
  
### Pre-treatment  
Given that time explains the most data variation, let's take a look within Pre-treatment samples:  
```{r, include=F}
### Pre-treatment
bray.nmds.pre <- ordinate(physeq=physeq.pre, method="NMDS", distance="bray")
  # stress = 0.1847002

test <- plot_ordination(physeq=physeq.pre, ordination=bray.nmds.pre, color="Treatment", shape="Sex") +
  scale_color_manual(values=c("brown2", "rosybrown", "limegreen", "dodgerblue2")) +
  scale_shape_manual(values=c(19,24)) +
  geom_point(size=2, stroke=1.5)
test$layers <- test$layers[-1]
```

```{r, echo=F, fig.height=4.5, fig.width=7}
### Pre-treatment
test
```
  
* There is no significance between treatments.  
* There *is* a significant difference between sex (adj pval = 0.005).
  
### Post-treatment  
```{r, include=F}
### Post-treatment
bray.nmds.post <- ordinate(physeq=physeq.post, method="NMDS", distance="bray")
  # stress = 8.927466e-05

test <- plot_ordination(physeq=physeq.post, ordination=bray.nmds.post, color="Treatment", shape="Sex") +
  scale_color_manual(values=c("brown2", "rosybrown", "limegreen", "dodgerblue2")) +
  scale_shape_manual(values=c(19,24)) +
  geom_point(size=2, stroke=1.5)
test$layers <- test$layers[-1]
```

```{r, echo=F, fig.height=4.5, fig.width=7}
### Post-treatment
test
```
  
* Unlike in Pre-treatment samples, sex is not significant in Post-treatment samples (adj p-val = 0.326)
* Low Fat is significantly different from all other treatments (all adj pvals = 0.005)
    + This is true overall, and within Females and within and Males
* Saccharin vs. Stevia trend towards a difference (adj pval = 0.063)
    + This trend is seen within Females (adj pval = 0.063), but not within Males (adj pval = 0.571)
  
# Important OTUs  
I identified the OTUs that contribute the most to variation in between-sample diversity. These OTUs are the most abundant and/or variable in the samples.    
  
### Post-treatment  
#### Low Fat vs. Other Treatments  
The difference between Low Fat vs. other treatments is driven by the following number of OTUs:  

* High Fat = 8
* Saccharin = 7
* Stevia = 9
  
Here are the significant OTUs:  
```{r, echo=F}
tab <- data.frame(rep("NA", 24))
colnames(tab) <- "Compared_Treatment"
tab$Compared_Treatment <- c(rep("High Fat",8), rep("Saccharin",7), rep("Stevia", 9))
tab$Variation_Explained <- c(4.03, 5.76, 4.50, 3.26, 2.48, 8.24, 4.71, 2.39, 9.57, 3.58, 2.50, 3.98, 2.08, 5.74, 4.77, 5.44, 4.72, 4.63, 4.28, 4.34, 2.47, 2.07, 4.82, 2.12)
tab$Adj_Pval <- c(7.10e-05, 0.0002, 0.0002, 0.0002, 0.0003, 0.004, 0.0062, 0.0071, 0.0957, 0.0358, 0.0250, 0.0398, 0.0208, 0.0574, 0.0477, 0.0544, 0.0472, 0.0463, 0.0428, 0.0433, 0.0247, 0.0207, 0.0482, 0.0212)
tab$Phylum <- c("Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Tenericutes", "Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Firmicutes", "Bacteroidetes", "Firmicutes", "Firmicutes", "Proteobacteria", "Firmicutes", "Firmicutes")
tab$Class <- c("Bacteroidia", "Bacteroidia", "Bacteroidia", "Mollicutes", "Bacteroidia", "Bacteroidia", "Bacteroidia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Clostridia", "Bacteroidia", "Clostridia", "Clostridia", "Betaproteobacteria", "Clostridia", "Clostridia")
tab$Order <- c("Bacteroidales", "Bacteroidales", "Bacteroidales", "Anaeroplasmatales", "Bacteroidales", "Bacteroidales", "Bacteroidales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Clostridiales", "Bacteroidales", "Clostridiales", "Clostridiales", "Burkholderiales", "Clostridiales", "Clostridiales")
tab$Family <- c("S24-7", "Bacteroidaceae", "S24-7", "Anaeroplasmataceae", "S24-7", "S24-7", "S24-7", "Ruminococcaceae", "Lachnospiraceae", "Ruminococcaceae", "Lachnospiraceae", "vadinBB60", "Lachnospiraceae", "Lachnospiraceae", "Ruminococcaceae", "Lachnospiraceae", "Lachnospiraceae", "Ruminococcaceae", "S24-7", "Lachnospiraceae", "Lachnospiraceae", "Alcaligenaceae", "Lachnospiraceae", "Lachnospiraceae")
tab$Genus <- c("Unclassified", "Bacteroides", "Unclassified", "Anaeroplasma", "Unclassified", "Unclassified", "Unclassified", "Ruminiclostridium", "Unclassified", "Ruminiclostridium", "Unclassified", "Unclassified", "NK4A136", "NK4A136", "Oscillibacter", "Unclassified", "NK4A136", "Unclassified", "Unclassified", "NK4A136", "NK4A136", "Parasutterella", "Unclassified", "Unclassified")
tab$Species <- c("OTU 14", "OTU 4", "OTU 12", "OTU 10", "OTU 8", "OTU 2", "OTU 23", "OTU 3", "OTU 2", "OTU 10", "OTU 8", "OTU 12", "OTU 21", "OTU 4", "OTU 23", "OTU 14", "OTU 4", "OTU 12", "OTU 10", "OTU 2", "OTU 8", "OTU 21", "OTU 23", "OTU 3")
tab$LowFat_RelAbund <- c(0, 1.22, 0.37, 0.81, 3.97, 0.19, 7.92, 3.39, 0.19, 0.81, 3.97, 0.37, 3.30, 1.22, 7.92, 0, 1.22, 0.37, 0.81, 0.19, 3.97, 3.30, 7.92, 3.38)
tab$Compared_Treatment_RelAbund <- c(6.45, 10.44, 7.57, 6.03, 0, 13.29, 0.70, 6.77, 15.33, 6.48, 0.01, 6.64, 0.01, 10.04, 6.28, 8.71, 8.78, 7.77, 7.67, 7.04, 0.01, 0, 0.39, 6.29)
colnames(tab) <- c("Compared Treatment", "Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Low Fat Rel Abund (%)", "Compared Treatment Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)

# 13 (higher in HF/TV), 4 (higher in all), 12 (higher in all), 10 (higher in all), 8 (lower in all), 2 (higher in all), 23 (lower in all), 3 (higher in GF/TV), 10 (Higher in SC/TV), 21 (Lower in SC/TV)
```
  
#### High Fat vs. Saccharin  
```{r, echo=F}
tab <- data.frame(rep("NA", 5))
tab[,1] <- c(4.05)
tab$Adj_Pval <- c(0.0638)
tab$Phylum <- c("Firmicutes")
tab$Class <- c("Clostridia")
tab$Order <- c("Clostridiales")
tab$Family <- c("Lachnospiraceae")
tab$Genus <- c("Unclassified")
tab$Species <- c("OTU 14")
tab$HighFat_RelAbund <- c(6.45)
tab$Saccharin_RelAbund <- c(3.18)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "High Fat Rel Abund (%)", "Saccharin Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
```
  
#### Saccharin vs. Stevia  
```{r, echo=F}
tab <- data.frame(rep("NA", 5))
tab[,1] <- c(6.19)
tab$Adj_Pval <- c(0.0043)
tab$Phylum <- c("Firmicutes")
tab$Class <- c("Clostridia")
tab$Order <- c("Clostridiales")
tab$Family <- c("Lachnospiraceae")
tab$Genus <- c("Lachnoclostridium")
tab$Species <- c("OTU 14")
tab$Saccharin_RelAbund <- c(3.18)
tab$Stevia_RelAbund <- c(8.71)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Saccharin Rel Abund (%)", "Stevia Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
```

```{r, echo=F}
tab <- data.frame(rep("NA", 5))
colnames(tab) <- "Variation_Explained(%)"
tab[,1] <- c()
tab$Adj_Pval <- c()
tab$Phylum <- c()
tab$Class <- c()
tab$Order <- c()
tab$Family <- c()
tab$Genus <- c()
tab$Species <- c()
tab$Pre_RelAbund <- c()
tab$Post_RelAbund <- c()
```

```{r, echo=F}
tab <- data.frame(rep("NA", 5))
colnames(tab) <- "Variation_Explained(%)"
tab[,1] <- c()
tab$Adj_Pval <- c()
tab$Phylum <- c()
tab$Class <- c()
tab$Order <- c()
tab$Family <- c()
tab$Genus <- c()
tab$Species <- c()
tab$Pre_RelAbund <- c()
tab$Post_RelAbund <- c()
```
### High Fat  
#### Pre-treatment vs. Post-treatment  
```{r, echo=F}
tab <- data.frame(rep("NA", 6))
colnames(tab) <- "Variation_Explained(%)"
tab[,1] <- c(4.91, 4.69, 4.13, 3.49, 3.25, 2.42)
tab$Adj_Pval <- c(0.0017, 0.0036, 0.0021, 0.0125, 0.0036, 0.0040)
tab$Phylum <- c("Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Firmicutes", "Bacteroidetes")
tab$Class <- c("Bacteroidia", "Bacteroidia", "Bacteroidia", "Bacteroidia", "Clostridia", "Bacteroidia")
tab$Order <- c("Bacteroidales", "Bacteroidales", "Bacteroidales", "Bacteroidales", "Clostridiales", "Bacteroidales")
tab$Family <- c("Bacteroidiaceae", "S24-7", "S24-7", "S24-7", "Ruminococcaceae", "S24-7")
tab$Genus <- c("Unclassified", "Unclassified", "Unclassified", "Unclassified", "Ruminiclostridium", "Unclassified")
tab$Species <- c("OTU 5", "OTU 12", "OTU 14", "OTU4", "OTU 10", "OTU 15")
tab$Pre_RelAbund <- c(8.39, 0.025, 0, 5.17, 0.96, 0.38)
tab$Post_RelAbund <- c(0.81, 7.57, 6.45, 10.44, 6.03, 0)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Pre Rel Abund (%)", "Post Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
kable(tab, "html") %>% kable_styling(full_width=F)
```

### Low Fat  
#### Pre-treatment vs. Post-treatment  
```{r, echo=F}
tab <- data.frame(rep("NA", 3))
colnames(tab) <- "Variation_Explained(%)"
tab[,1] <- c(5.83, 3.21, 3.00)
tab$Adj_Pval <- c(0.0092, 0.0337, 0.0139)
tab$Phylum <- c("Bacteroidetes", "Tenericutes", "Firmicutes")
tab$Class <- c("Bacteroidia", "Mollicutes", "Clostridia")
tab$Order <- c("Bacteroidales", "Anaeroplasmatales", "Clostridiales")
tab$Family <- c("Bacteroidaceae", "Anaeroplasmataceae", "Ruminococcaceae")
tab$Genus <- c("Bacteroides", "Anaeroplasma", "Ruminiclostridium")
tab$Species <- c("OTU 23", "OTU 3", "OTU 15")
tab$Pre_RelAbund <- c(0.61, 7.11, 4.49)
tab$Post_RelAbund <- c(7.92, 3.38, 0.85)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Pre Rel Abund (%)", "Post Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
```

### Saccharin  
#### Pre-treatment vs. Post-treatment  
```{r, echo=F}
tab <- data.frame(rep("NA", 5))
colnames(tab) <- "Variation_Explained(%)"
tab[,1] <- c(7.12, 4.52, 4.22, 3.48, 3.16)
tab$Adj_Pval <- c(0.0125, 0.0247, 0.0051, 0.0056, 0.0071)
tab$Phylum <- c("Verrucomicrobia", "Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Tenericutes")
tab$Class <- c("Verrucomicrobiae", "Bacteroidia", "Bacteroidia", "Bacteroidia", "Mollicutes")
tab$Order <- c("Verrucomicrobiales", "S24-7", "S24-7", "S24-7", "Anaeroplasmatales")
tab$Family <- c("Verrucomicrobiaceae", "Unclassified", "Unclassified", "Unclassified", "Anaeroplasmataceae")
tab$Genus <- c("Akkermansia", "Unclassified", "Unclassified", "Unclassified", "Anaeroplasma")
tab$Species <- c("OTU 5", "OTU 4", "OTU 12", "OTU 8", "OTU 10")
tab$Pre_RelAbund <- c(11.50, 4.10, 0.24, 5.32, 1.84)
tab$Post_RelAbund <- c(0.77, 10.04, 6.64, 0.01, 6.48)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Pre Rel Abund (%)", "Post Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
```

### Stevia  
#### Pre-treatment vs. Post-treatment  
```{r, echo=F}
tab <- data.frame(rep("NA", 6))
colnames(tab) <- "Variation_Explained(%)"
tab[,1] <- c(5.62, 4.89, 4.40, 4.18, 3.68, 3.40)
tab$Adj_Pval <- c(0.0036, 0.0049, 0.0139, 0.0056, 0.0043, 0.0125)
tab$Phylum <- c("Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Bacteroidetes", "Firmicutes")
tab$Class <- c("Bacteroidia", "Bacteroidia", "Bacteroidia", "Bacteroidia", "Bacteroidia", "Clostridia")
tab$Order <- c("Bacteroidales", "Bacteroidales", "Bacteroidales", "Bacteroidales", "Bacteroidales", "Clostridiales")
tab$Family <- c("S24-7", "Bacteroidaceae", "S24-7", "S24-7", "S24-7", "Ruminococcaceae")
tab$Genus <- c("Unclassified", "Bacteroides", "Unclassified", "Unclassified", "Unclassified", "Ruminiclostridium")
tab$Species <- c("OTU 14", "OTU 12", "OTU 5", "OTU 10", "OTU 8", "OTU 4")
tab$Pre_RelAbund <- c(0, 0.19, 7.34, 1.21, 5.75, 3.58)
tab$Post_RelAbund <- c(8.71, 7.77, 0.53, 7.67, 0.01, 8.78)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Pre Rel Abund (%)", "Post Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
```
  
### Male vs. Female (Pre-treatment)  
No OTUs were detected Post-treatment
```{r, echo=F}
tab <- data.frame(rep("NA", 5))
tab[,1] <- c(9.74, 7.97, 7.06, 5.85, 5.58)
tab$Adj_Pval <- c(5.31e-06, 3.77e-05, 0.0075, 0.0002, 0.0001)
tab$Phylum <- c("Firmicutes", "Bacteroidetes", "Firmicutes", "Firmicutes", "Firmicutes")
tab$Class <- c("Clostridia", "Bacteroidia", "Clostridia", "Erysipelotrichia", "Clostridia")
tab$Order <- c("Clostridiales", "Bactteroidales", "Clostridiales", "Erysipelotrichales", "Clostridiales")
tab$Family <- c("Ruminococcaceae", "S24-7", "Lachnospiraceae", "Erysipelotrichaceae", "Lachnospiraceae")
tab$Genus <- c("Ruminiclostridium", "Unclassified", "Unclassified", "Unclassified", "Tyzzerella")
tab$Species <- c("OTU 6", "OTU 13", "OTU 5", "OTU 11", "OTU 8")
tab$Female_RelAbund <- c(12.34, 0.17, 3.86, 8.14, 9.18)
tab$Male_RelAbund <- c(0.01, 10.22, 11.42, 1.44, 2.29)
colnames(tab) <- c("Variation Explained (%)", "Adj Pval", "Phylum", "Class", "Order", "Family", "Genus", "OTU", "Female Rel Abund (%)", "Male Rel Abund (%)")
kable(tab, "html") %>% kable_styling(full_width=F)
```